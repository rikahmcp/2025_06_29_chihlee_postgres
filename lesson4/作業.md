### 範例 7. 台灣有多少人在2020確診?

```sql
SELECT MAX(總確診數) AS 總確診數
FROM world
WHERE 國家 = '台灣' AND 日期 BETWEEN '2020-01-01' AND '2020-12-31';
```

| 總確診數 |
| --- | 
| 799 | 

### 1. 查詢亞洲總共有多少人死亡

```sql
SELECT SUM(總死亡數) AS 亞洲總死亡人數
FROM world
WHERE 洲名 = '亞洲';
```

| 亞洲總死亡人數 |
| --- | 
| 586352046| 

### 2. 查詢全世界2020年的總確診數

```sql
SELECT MAX(總確診數) AS "2020年全球累計確診數"
FROM world
WHERE EXTRACT(YEAR FROM 日期) = 2020
	and 國家 = '全球';
```

| 2020年全世界累計總確診數 |
| --- | 
| 83750045| 

### 3. 查國家名有"阿"字,總死亡數大於10000

```sql
SELECT 國家, 總死亡數
FROM world
WHERE 國家 LIKE '%阿%'
  AND 總死亡數 > 10000
  AND 總死亡數 = (
    SELECT MAX(總死亡數)
    FROM world
    WHERE 國家 LIKE '%阿%'
      AND 總死亡數 > 10000
  );
```

| 國家 | 總死亡數 |
| --- | --- | 
| 沙烏地阿拉伯	| 5374998 |
| 阿富汗	| 3497795 |
| 阿拉伯聯合大公國	| 1150068 |
| 阿曼	| 2046967 |
| 阿根廷	| 59070090 |
| 阿爾及利亞	| 3208864 |
| 阿爾巴尼亞	| 1603932 |
| 阿魯巴	| 86650 |

### 4. 查詢哪個國家總確診數最多

```sql
SELECT 國家, 總確診數
FROM world
WHERE 國家 <> '全球'
ORDER BY 總確診數 DESC
LIMIT 1;
```

| 國家 | 總確診數 |
| --- | --- | 
| 美國 | 88263393 |

### 5. 查詢亞洲台灣 2020-06-25 的總確診數

```sql
SELECT 總確診數 AS "20200625_總確診"
FROM world
WHERE 洲名 = '亞洲'
  AND 國家 = '台灣'
  AND 日期 = '2020-06-25';
```

| 總確診數 |
| --- | 
| 447 |

### 6. 總死亡數最高的國家

```sql
SELECT 國家, 總死亡數
FROM world
WHERE 國家 <> '全球'
ORDER BY 總死亡數 DESC
LIMIT 1;
```
| 國家 | 總確診數 |
| --- | --- | 
| 美國 | 1019083 |

### 7. 台灣有多少人在2020確診?
```sql
SELECT "2020總確診數"
FROM world
WHERE 國家 = '台灣'
  AND 日期 = '2020-12-31';
```
| 2020總確診數 |
| --- | 
| 799 |

### 8. 排序各國確診數
```sql
SELECT 國家, 總確診數
FROM (
    SELECT *,
           ROW_NUMBER() OVER (PARTITION BY 國家 ORDER BY 日期 DESC) AS rn
    FROM world
) sub
WHERE rn = 1
  AND 國家 <> '全球'
ORDER BY 總確診數 DESC;
LIMIT 10;
```
| 國家 | 總確診數 |
| --- | --- | 
| 美國	| 88263393 | 
| 印度	| 43566739 | 
| 巴西	| 32687680 | 
| 法國	| 31874114 | 
| 德國	| 28808614 | 
| 英國	| 22965982 |
| 義大利	| 19048788 |
| 韓國	| 18451862 |
| 俄羅斯	| 18179254 |
| 土耳其	| 15180444 |

### 9. 查詢每百萬確診人數
```sql
SELECT 
    w.國家,
    w.總確診數,
    w.總人口數,
    ROUND((w.總確診數::numeric / w.總人口數) * 1000000, 2) AS 每百萬確診人數
FROM world w
JOIN (
    SELECT 國家, MAX(日期) AS max_date
    FROM world
    GROUP BY 國家
) latest ON w.國家 = latest.國家 AND w.日期 = latest.max_date
WHERE w.總人口數 > 0
ORDER BY 每百萬確診人數 DESC
LIMIT 10;
```
| 國家 | 總確診數 | 總人口數 | 每百萬確診人數 |
| --- | --- |  --- |  --- | 
|法羅群島	|34658|	49053	|706541.90|
|直布羅陀	|19633	|33691	|582737.23|
|安道爾	|44671	|77354|	577487.91|
|賽普勒斯	|515596	|896005	|575438.75|
|丹麥	|3183166	|5813302	|547565.91|
|聖馬利諾	|18361	|34010	|539870.63|
|冰島	|196527	|368792	|532893.88|
|福克蘭群島|	1831	|3528	|518990.93|
|葡萄牙	|5225205	|10167923	|513891.09|
|斯洛維尼亞|	1044765	|2078723	|502599.43|

### 10. 台灣哪個月死亡人數最多人
```sql
SELECT 
  TO_CHAR(日期, 'YYYY-MM') AS 年月,
  SUM(新增死亡數) AS 月死亡人數
FROM world
WHERE 國家 = '台灣'
GROUP BY 年月
ORDER BY 月死亡人數 DESC
LIMIT 1;
```
| 年月 | 月死亡人數 |
| --- | --- | 
| 2022-06	| 4396 | 

### 11. 在哪個年度及月分，死亡數達到高峰
```sql
SELECT 
  TO_CHAR(日期, 'YYYY-MM') AS 年月,
  SUM(新增死亡數) AS 月死亡人數
FROM world
WHERE 國家 = '全球'
GROUP BY 年月
ORDER BY 月死亡人數 DESC
LIMIT 1;
```
| 年月 | 月死亡人數 |
| --- | --- | 
|2021-01	|418048|


